import{l as e,r as n,t,a as o,F as r,c as i,j as a}from"./app-55aa7177.js";import{u as s,c as l,a as c}from"./index.esm-fd5c7a63.js";import{W as u}from"./WhatsAppUiPreview-0e7d8ea2.js";import{A as d}from"./AlertComponent-50ec0d3b.js";import{AddEventButton as p}from"./EventItem-e2c95f98.js";import"./index.es-e0312cba.js";import"./ScrollScreen-6240e508.js";import"./moment-0b360bb8.js";import"./transition-1b81608f.js";var f,h,m,v=globalThis&&globalThis.__assign||function(){return v=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},v.apply(this,arguments)},g={onActivate:e.func,onAddUndo:e.func,onBeforeAddUndo:e.func,onBeforeExecCommand:e.func,onBeforeGetContent:e.func,onBeforeRenderUI:e.func,onBeforeSetContent:e.func,onBeforePaste:e.func,onBlur:e.func,onChange:e.func,onClearUndos:e.func,onClick:e.func,onContextMenu:e.func,onCommentChange:e.func,onCopy:e.func,onCut:e.func,onDblclick:e.func,onDeactivate:e.func,onDirty:e.func,onDrag:e.func,onDragDrop:e.func,onDragEnd:e.func,onDragGesture:e.func,onDragOver:e.func,onDrop:e.func,onExecCommand:e.func,onFocus:e.func,onFocusIn:e.func,onFocusOut:e.func,onGetContent:e.func,onHide:e.func,onInit:e.func,onKeyDown:e.func,onKeyPress:e.func,onKeyUp:e.func,onLoadContent:e.func,onMouseDown:e.func,onMouseEnter:e.func,onMouseLeave:e.func,onMouseMove:e.func,onMouseOut:e.func,onMouseOver:e.func,onMouseUp:e.func,onNodeChange:e.func,onObjectResizeStart:e.func,onObjectResized:e.func,onObjectSelected:e.func,onPaste:e.func,onPostProcess:e.func,onPostRender:e.func,onPreProcess:e.func,onProgressState:e.func,onRedo:e.func,onRemove:e.func,onReset:e.func,onSaveContent:e.func,onSelectionChange:e.func,onSetAttrib:e.func,onSetContent:e.func,onShow:e.func,onSubmit:e.func,onUndo:e.func,onVisualAid:e.func,onSkinLoadError:e.func,onThemeLoadError:e.func,onModelLoadError:e.func,onPluginLoadError:e.func,onIconsLoadError:e.func,onLanguageLoadError:e.func,onScriptsLoad:e.func,onScriptsLoadError:e.func},y=v({apiKey:e.string,id:e.string,inline:e.bool,init:e.object,initialValue:e.string,onEditorChange:e.func,value:e.string,tagName:e.string,cloudChannel:e.string,plugins:e.oneOfType([e.string,e.array]),toolbar:e.oneOfType([e.string,e.array]),disabled:e.bool,textareaName:e.string,tinymceScriptSrc:e.oneOfType([e.string,e.arrayOf(e.string),e.arrayOf(e.shape({src:e.string,async:e.bool,defer:e.bool}))]),rollback:e.oneOfType([e.number,e.oneOf([!1])]),scriptLoading:e.shape({async:e.bool,defer:e.bool,delay:e.number})},g),b=function(e){return"function"==typeof e},C=function(e){return e in g},S=function(e){return e.substr(2)},E=function(e,n,t,o,r){return function(e,n,t,o,r,i,a){var s=Object.keys(r).filter(C),l=Object.keys(i).filter(C),c=s.filter((function(e){return void 0===i[e]})),u=l.filter((function(e){return void 0===r[e]}));c.forEach((function(e){var n=S(e),o=a[n];t(n,o),delete a[n]})),u.forEach((function(t){var r=o(e,t),i=S(t);a[i]=r,n(i,r)}))}(r,e.on.bind(e),e.off.bind(e),(function(n,t){return function(o){var r;return null===(r=n(t))||void 0===r?void 0:r(o,e)}}),n,t,o)},k=0,w=function(e){var n=Date.now();return e+"_"+Math.floor(1e9*Math.random())+ ++k+String(n)},T=function(e){return null!==e&&("textarea"===e.tagName.toLowerCase()||"input"===e.tagName.toLowerCase())},I=function(e){return void 0===e||""===e?[]:Array.isArray(e)?e:e.split(" ")},j=function(e,n){void 0!==e&&(null!=e.mode&&"object"==typeof e.mode&&"function"==typeof e.mode.set?e.mode.set(n):e.setMode(n))},N=globalThis&&globalThis.__assign||function(){return N=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},N.apply(this,arguments)},O=function(e,n,t){var o,r,i=e.createElement("script");i.referrerPolicy="origin",i.type="application/javascript",i.id=n.id,i.src=n.src,i.async=null!==(o=n.async)&&void 0!==o&&o,i.defer=null!==(r=n.defer)&&void 0!==r&&r;var a=function(){i.removeEventListener("load",a),i.removeEventListener("error",s),t(n.src)},s=function(e){i.removeEventListener("load",a),i.removeEventListener("error",s),t(n.src,e)};i.addEventListener("load",a),i.addEventListener("error",s),e.head&&e.head.appendChild(i)},B=(f=[],h=function(e){var n=f.find((function(n){return n.getDocument()===e}));return void 0===n&&(n=function(e){var n={},t=function(e,t){var o=n[e];o.done=!0,o.error=t;for(var r=0,i=o.handlers;r<i.length;r++)(0,i[r])(e,t);o.handlers=[]};return{loadScripts:function(o,r,i){var a=function(e){return void 0!==i?i(e):console.error(e)};if(0!==o.length)for(var s=0,l=!1,c=function(e,n){l||(n?(l=!0,a(n)):++s===o.length&&r())},u=0,d=o;u<d.length;u++){var p=d[u],f=n[p.src];if(f)f.done?c(p.src,f.error):f.handlers.push(c);else{var h=w("tiny-");n[p.src]={id:h,src:p.src,done:!1,error:null,handlers:[c]},O(e,N({id:h},p),t)}}else a(new Error("At least one script must be provided"))},deleteScripts:function(){for(var t,o=0,r=Object.values(n);o<r.length;o++){var i=r[o],a=e.getElementById(i.id);null!=a&&"SCRIPT"===a.tagName&&(null===(t=a.parentNode)||void 0===t||t.removeChild(a))}n={}},getDocument:function(){return e}}}(e),f.push(n)),n},{loadList:function(e,n,t,o,r){var i=function(){return h(e).loadScripts(n,o,r)};t>0?setTimeout(i,t):i()},reinitialize:function(){for(var e=f.pop();null!=e;e=f.pop())e.deleteScripts()}}),L=function(e){var n=e;return n&&n.tinymce?n.tinymce:null},_=globalThis&&globalThis.__extends||(m=function(e,n){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function t(){this.constructor=e}m(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}),x=globalThis&&globalThis.__assign||function(){return x=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},x.apply(this,arguments)},D=function(e){function t(t){var o,r,i,a=this;return(a=e.call(this,t)||this).rollbackTimer=void 0,a.valueCursor=void 0,a.rollbackChange=function(){var e=a.editor,n=a.props.value;e&&n&&n!==a.currentContent&&e.undoManager.ignore((function(){if(e.setContent(n),a.valueCursor&&(!a.inline||e.hasFocus()))try{e.selection.moveToBookmark(a.valueCursor)}catch(t){}})),a.rollbackTimer=void 0},a.handleBeforeInput=function(e){if(void 0!==a.props.value&&a.props.value===a.currentContent&&a.editor&&(!a.inline||a.editor.hasFocus()))try{a.valueCursor=a.editor.selection.getBookmark(3)}catch(n){}},a.handleBeforeInputSpecial=function(e){"Enter"!==e.key&&"Backspace"!==e.key&&"Delete"!==e.key||a.handleBeforeInput(e)},a.handleEditorChange=function(e){var n=a.editor;if(n&&n.initialized){var t=n.getContent();void 0!==a.props.value&&a.props.value!==t&&!1!==a.props.rollback&&(a.rollbackTimer||(a.rollbackTimer=window.setTimeout(a.rollbackChange,"number"==typeof a.props.rollback?a.props.rollback:200))),t!==a.currentContent&&(a.currentContent=t,b(a.props.onEditorChange)&&a.props.onEditorChange(t,n))}},a.handleEditorChangeSpecial=function(e){"Backspace"!==e.key&&"Delete"!==e.key||a.handleEditorChange(e)},a.initialise=function(e){var n,t,o;void 0===e&&(e=0);var r=a.elementRef.current;if(r)if(function(e){if(!("isConnected"in Node.prototype)){for(var n=e,t=e.parentNode;null!=t;)t=(n=t).parentNode;return n===e.ownerDocument}return e.isConnected}(r)){var i=L(a.view);if(!i)throw new Error("tinymce should have been loaded into global scope");var s,l,c=x(x({},a.props.init),{selector:void 0,target:r,readonly:a.props.disabled,inline:a.inline,plugins:(s=null===(n=a.props.init)||void 0===n?void 0:n.plugins,l=a.props.plugins,I(s).concat(I(l))),toolbar:null!==(t=a.props.toolbar)&&void 0!==t?t:null===(o=a.props.init)||void 0===o?void 0:o.toolbar,setup:function(e){a.editor=e,a.bindHandlers({}),a.inline&&!T(r)&&e.once("PostRender",(function(n){e.setContent(a.getInitialValue(),{no_events:!0})})),a.props.init&&b(a.props.init.setup)&&a.props.init.setup(e)},init_instance_callback:function(e){var n,t,o=a.getInitialValue();a.currentContent=null!==(n=a.currentContent)&&void 0!==n?n:e.getContent(),a.currentContent!==o&&(a.currentContent=o,e.setContent(o),e.undoManager.clear(),e.undoManager.add(),e.setDirty(!1));var r=null!==(t=a.props.disabled)&&void 0!==t&&t;j(a.editor,r?"readonly":"design"),a.props.init&&b(a.props.init.init_instance_callback)&&a.props.init.init_instance_callback(e)}});a.inline||(r.style.visibility=""),T(r)&&(r.value=a.getInitialValue()),i.init(c)}else if(0===e)setTimeout((function(){return a.initialise(1)}),1);else{if(!(e<100))throw new Error("tinymce can only be initialised when in a document");setTimeout((function(){return a.initialise(e+1)}),100)}},a.id=a.props.id||w("tiny-react"),a.elementRef=n.createRef(),a.inline=null!==(i=null!==(o=a.props.inline)&&void 0!==o?o:null===(r=a.props.init)||void 0===r?void 0:r.inline)&&void 0!==i&&i,a.boundHandlers={},a}return _(t,e),Object.defineProperty(t.prototype,"view",{get:function(){var e,n;return null!==(n=null===(e=this.elementRef.current)||void 0===e?void 0:e.ownerDocument.defaultView)&&void 0!==n?n:window},enumerable:!1,configurable:!0}),t.prototype.componentDidUpdate=function(e){var n,t,o=this;if(this.rollbackTimer&&(clearTimeout(this.rollbackTimer),this.rollbackTimer=void 0),this.editor&&(this.bindHandlers(e),this.editor.initialized)){if(this.currentContent=null!==(n=this.currentContent)&&void 0!==n?n:this.editor.getContent(),"string"==typeof this.props.initialValue&&this.props.initialValue!==e.initialValue)this.editor.setContent(this.props.initialValue),this.editor.undoManager.clear(),this.editor.undoManager.add(),this.editor.setDirty(!1);else if("string"==typeof this.props.value&&this.props.value!==this.currentContent){var r=this.editor;r.undoManager.transact((function(){var e;if(!o.inline||r.hasFocus())try{e=r.selection.getBookmark(3)}catch(s){}var n=o.valueCursor;if(r.setContent(o.props.value),!o.inline||r.hasFocus())for(var t=0,i=[e,n];t<i.length;t++){var a=i[t];if(a)try{r.selection.moveToBookmark(a),o.valueCursor=a;break}catch(s){}}}))}if(this.props.disabled!==e.disabled){var i=null!==(t=this.props.disabled)&&void 0!==t&&t;j(this.editor,i?"readonly":"design")}}},t.prototype.componentDidMount=function(){var e,n,t,o,r,i=this;if(null!==L(this.view))this.initialise();else if(Array.isArray(this.props.tinymceScriptSrc)&&0===this.props.tinymceScriptSrc.length)null===(n=(e=this.props).onScriptsLoadError)||void 0===n||n.call(e,new Error("No `tinymce` global is present but the `tinymceScriptSrc` prop was an empty array."));else if(null===(t=this.elementRef.current)||void 0===t?void 0:t.ownerDocument){B.loadList(this.elementRef.current.ownerDocument,this.getScriptSources(),null!==(r=null===(o=this.props.scriptLoading)||void 0===o?void 0:o.delay)&&void 0!==r?r:0,(function(){var e,n;null===(n=(e=i.props).onScriptsLoad)||void 0===n||n.call(e),i.initialise()}),(function(e){var n,t;null===(t=(n=i.props).onScriptsLoadError)||void 0===t||t.call(n,e)}))}},t.prototype.componentWillUnmount=function(){var e=this,n=this.editor;n&&(n.off(this.changeEvents(),this.handleEditorChange),n.off(this.beforeInputEvent(),this.handleBeforeInput),n.off("keypress",this.handleEditorChangeSpecial),n.off("keydown",this.handleBeforeInputSpecial),n.off("NewBlock",this.handleEditorChange),Object.keys(this.boundHandlers).forEach((function(t){n.off(t,e.boundHandlers[t])})),this.boundHandlers={},n.remove(),this.editor=void 0)},t.prototype.render=function(){return this.inline?this.renderInline():this.renderIframe()},t.prototype.changeEvents=function(){var e,n,t;return(null===(t=null===(n=null===(e=L(this.view))||void 0===e?void 0:e.Env)||void 0===n?void 0:n.browser)||void 0===t?void 0:t.isIE())?"change keyup compositionend setcontent CommentChange":"change input compositionend setcontent CommentChange"},t.prototype.beforeInputEvent=function(){return window.InputEvent&&"function"==typeof InputEvent.prototype.getTargetRanges?"beforeinput SelectionChange":"SelectionChange"},t.prototype.renderInline=function(){var e=this.props.tagName,t=void 0===e?"div":e;return n.createElement(t,{ref:this.elementRef,id:this.id})},t.prototype.renderIframe=function(){return n.createElement("textarea",{ref:this.elementRef,style:{visibility:"hidden"},name:this.props.textareaName,id:this.id})},t.prototype.getScriptSources=function(){var e,n,t=null===(e=this.props.scriptLoading)||void 0===e?void 0:e.async,o=null===(n=this.props.scriptLoading)||void 0===n?void 0:n.defer;if(void 0!==this.props.tinymceScriptSrc)return"string"==typeof this.props.tinymceScriptSrc?[{src:this.props.tinymceScriptSrc,async:t,defer:o}]:this.props.tinymceScriptSrc.map((function(e){return"string"==typeof e?{src:e,async:t,defer:o}:e}));var r=this.props.cloudChannel,i=this.props.apiKey?this.props.apiKey:"no-api-key";return[{src:"https://cdn.tiny.cloud/1/".concat(i,"/tinymce/").concat(r,"/tinymce.min.js"),async:t,defer:o}]},t.prototype.getInitialValue=function(){return"string"==typeof this.props.initialValue?this.props.initialValue:"string"==typeof this.props.value?this.props.value:""},t.prototype.bindHandlers=function(e){var n=this;if(void 0!==this.editor){E(this.editor,e,this.props,this.boundHandlers,(function(e){return n.props[e]}));var t=function(e){return void 0!==e.onEditorChange||void 0!==e.value},o=t(e),r=t(this.props);!o&&r?(this.editor.on(this.changeEvents(),this.handleEditorChange),this.editor.on(this.beforeInputEvent(),this.handleBeforeInput),this.editor.on("keydown",this.handleBeforeInputSpecial),this.editor.on("keyup",this.handleEditorChangeSpecial),this.editor.on("NewBlock",this.handleEditorChange)):o&&!r&&(this.editor.off(this.changeEvents(),this.handleEditorChange),this.editor.off(this.beforeInputEvent(),this.handleBeforeInput),this.editor.off("keydown",this.handleBeforeInputSpecial),this.editor.off("keyup",this.handleEditorChangeSpecial),this.editor.off("NewBlock",this.handleEditorChange))}},t.propTypes=y,t.defaultProps={cloudChannel:"6"},t}(n.Component);const P=({events:e,waTemplates:f})=>{const[h,m]=n.useState(!1),v=n.useRef(),[g,y]=t(),b=s({initialValues:{id:f[0].id,template_name:f[0].template_name,title:f[0].title,message:f[0].message},validationSchema:l().shape({id:c().trim()}),onSubmit:e=>{g(e)}});n.useEffect((()=>{C(f[0].id)}),[h]);const C=e=>{var n,t;const o=null==f?void 0:f.filter((n=>n.id==e))[0];o&&(b.setFieldValue("id",e),b.setFieldValue("template_name",o.template_name),b.setFieldValue("title",o.title),b.setFieldValue("message",o.message),h&&(null==(t=null==(n=null==window?void 0:window.tinymce)?void 0:n.activeEditor)||t.setContent(o.message)))};return o(r,{children:e.length>0?o(r,{children:o(i.Card,{className:"h-full w-full p-2 sm:p-6",children:a("form",{onSubmit:b.handleSubmit,children:[o(i.CardHeader,{floated:!1,shadow:!1,className:"rounded-none",children:o("div",{className:"flex items-center justify-between gap-8",children:a("div",{children:[o(i.Typography,{variant:"h5",color:"gray",className:"text-lg font-medium",children:"WhatsApp Blast Invitation Template"}),o(i.Typography,{color:"gray",className:"mt-1 text-sm",children:"Setting template pesan WhatsApp yang akan di kirim ke seluruh tamu undangan"})]})})}),o(i.CardBody,{className:"px-0 p-4",children:a("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:[a("div",{className:"space-y-6",children:[a("section",{children:[f&&o(i.Select,{label:"WA Blast Template",size:"lg",...b.getFieldProps("id"),onChange:C,error:!(!b.errors.id||!b.touched.id),children:null==f?void 0:f.map((e=>o(i.Option,{value:e.id,children:e.template_name},e.id)))}),b.errors.id&&b.touched.id&&o(i.Typography,{variant:"small",color:"red",className:"flex items-center gap-1 font-normal mt-2",children:b.errors.id})]}),a("section",{children:[o(i.Input,{type:"text",size:"lg",label:"Title",...b.getFieldProps("title"),error:!(!b.errors.title||!b.touched.title)}),b.errors.title&&b.touched.title&&o(i.Typography,{variant:"small",color:"red",className:"flex items-center gap-1 font-normal mt-2",children:b.errors.title})]}),a("section",{children:[o(D,{tinymceScriptSrc:"/tinymce/tinymce.min.js",onInit:(e,n)=>{v.current=n,m(!0)},init:{height:300,menubar:!1,toolbar:"undo redo | formatselect | bold italic",branding:!1},onEditorChange:e=>b.setFieldValue("message",e)}),o(i.Typography,{variant:"small",className:"flex items-center gap-1 font-normal mt-2",children:"**[name] akan digantikan oleh nama undangan,"}),o(i.Typography,{variant:"small",className:"flex items-center gap-1 font-normal mt-2",children:"**[event_name] akan digantikan oleh nama event."}),o(i.Typography,{variant:"small",className:"flex items-center gap-1 font-normal mt-2",children:"**Masing-masing enter akan dipisahkan oleh 1 line break (enter)"})]})]}),o("div",{className:"rounded-lg bg-fixed",style:{backgroundImage:'url("/img/bg-wa.jpg")'},children:o(u,{data:b.values,scrollHeight:"550px"})})]})}),a(i.CardFooter,{className:"grid grid-cols-2 content-end gap-3 border-t border-gray-50 p-4",children:[o("div",{children:o(d,{option:y})}),o("div",{className:"flex justify-end items-center gap-3",children:a(i.Button,{type:"submit",className:"flex items-center gap-3",disabled:y.isLoading,children:[y.isLoading&&o(i.Spinner,{className:"h-4 w-4"}),"Save"]})})]})]})})}):o(p,{onAddButtonClick:()=>router.get(route("events.create"))})})};export{P as default};
